DEFINIZIONE TABELLE



CREATE TABLE DIPENDENTE
(
    CodF CHAR(16) PRIMARY KEY DEFAULT 'AAAAAA00A00A000A'
	CHECK (CodF ~* '^[A-Za-z]{6}[0-9]{2}[A-Za-z][0-9]{2}[A-Za-z][0-9]{3}[A-Za-z]$'),
    Nome VARCHAR(30) NOT NULL DEFAULT '' 
	CHECK (Nome ~* '^[A-Za-z ]+$'),
    Cognome VARCHAR(30) NOT NULL
	CHECK (Cognome ~* '^[A-Za-z ]+$'),
    Salario REAL,
    Valutazione INTEGER NOT NULL
);

CREATE TABLE PROGETTO
(
    CodP INT PRIMARY KEY,
    Tipologia VARCHAR(30) NOT NULL,
    Descrizione VARCHAR(200)
);

CREATE TABLE SALA
(
    CodSala INTEGER PRIMARY KEY,
    Città VARCHAR(30) NOT NULL CHECK (Città ~* '^[A-Za-z ]+$'),
    Provincia CHAR(2) NOT NULL CHECK (Provincia ~* '^[A-Z]{2}$'),
    Indirizzo VARCHAR(50) NOT NULL CHECK (Indirizzo ~* '^[A-Za-z ]+$'),
    NumeroCivico INTEGER,
    NumPosti INTEGER NOT NULL
);

CREATE TABLE MEETINGF
(
    CodMF INTEGER PRIMARY KEY,
    CodP INTEGER,
    Data DATE NOT NULL,
    OraI TIME NOT NULL,
    OraF TIME NOT NULL,
    CodSala INTEGER,

    CONSTRAINT fk_mf_progetto FOREIGN KEY (CodP)
	REFERENCES PROGETTO(CodP)
	ON UPDATE CASCADE
	ON DELETE NO ACTION,
    CONSTRAINT fk_sala FOREIGN KEY (CodSala)
        REFERENCES SALA(CodSala)
	ON UPDATE CASCADE
	ON DELETE NO ACTION
);

CREATE TABLE MEETINGT
(
    CodMT INTEGER PRIMARY KEY,
    CodP INTEGER,
    Data DATE NOT NULL,
    OraI TIME NOT NULL,
    OraF TIME NOT NULL,
    Piattaforma VARCHAR(30) NOT NULL,
    NumLimite INTEGER,

    CONSTRAINT fk_mt_progetto FOREIGN KEY (CodP)
	REFERENCES PROGETTO(CodP)
	ON UPDATE CASCADE
	ON DELETE NO ACTION
);


CREATE TABLE PARTECIPANTE
(
    CodF CHAR(16),
    CodP INTEGER,
    Ruolo VARCHAR(30) NOT NULL,

    CONSTRAINT fk_CodF FOREIGN KEY(CodF)
        REFERENCES DIPENDENTE(CodF)
	ON UPDATE CASCADE
	ON DELETE NO ACTION,
    CONSTRAINT fk_CodP FOREIGN KEY(CodP)
        REFERENCES PROGETTO(CodP)
	ON UPDATE CASCADE
	ON DELETE NO ACTION,
    CONSTRAINT u_Ruolo UNIQUE (CodF,CodP)
);

CREATE TABLE AMBITO
(
    CodP INTEGER ,
    Keyword VARCHAR(30) NOT NULL,
    CONSTRAINT fk_ambito FOREIGN KEY (CodP)
        REFERENCES PROGETTO(CodP)
	ON UPDATE CASCADE
	ON DELETE NO ACTION
);

CREATE TABLE PARTECIPAMF
(
    CodF CHAR(16),
    CodMF INTEGER,

    CONSTRAINT u_pmf UNIQUE(CodF, CodMF),
    CONSTRAINT fk1_MF FOREIGN KEY(CodF)
	REFERENCES DIPENDENTE(CodF)
	ON UPDATE CASCADE
	ON DELETE NO ACTION,
    CONSTRAINT fk2_MF FOREIGN KEY(CodMF)
	REFERENCES MEETINGF(CodMF)
	ON UPDATE CASCADE
	ON DELETE NO ACTION
);

CREATE TABLE PARTECIPAMT
(
    CodF CHAR(16),
    CodMT INTEGER,


    CONSTRAINT u_pmf UNIQUE(CodF, CodMT),
    CONSTRAINT fk1_MT FOREIGN KEY(CodF)
	REFERENCES DIPENDENTE(CodF)
	ON UPDATE CASCADE
	ON DELETE NO ACTION,
    CONSTRAINT fk2_MT FOREIGN KEY(CodMT)
	REFERENCES MEETINGT(CodMT)
	ON UPDATE CASCADE
	ON DELETE NO ACTION
);